* PROGRAM : VDISP_WIN

**************************
*PROCEDURE VDISP  IN DTN_PROC.PRG
**************************

IF _DOS
 SET CLOCK ON
 SET CLOCK TO 24,68
ELSE
SET CLOCK TO 30,100
ENDIF

SELECT 1
USE voucher

GOTO MREC2

SELECT 3
USE ldgrcode ORDER ac1

SELECT 1
R= 9

DO WHILE .not. EOF()
   @ R, 1 SAY SR_NO PICTURE '999' FONT 'FoxFont',11

IF _DOS
   SET COLOR TO /w
ENDIF

   @ R, 5 SAY C1 PICTURE '99' FONT 'FoxFont',11
   @ R, 7 SAY '-' FONT 'FoxFont',11
   @ R, 8 SAY C2 PICTURE '99' FONT 'FoxFont',11
   @ R, 10 SAY '-' FONT 'FoxFont',11
   @ R, 11 SAY C3 PICTURE '999' FONT 'FoxFont',11

IF _DOS
   SET COLOR TO /w
ENDIF

   STORE C1 TO MC1
   STORE C2 TO MC2
   STORE C3 TO MC3

   MPC1= REPLICATE('0',2-LEN(LTRIM(STR(MC1))))+LTRIM(STR(MC1))
   MPC2= REPLICATE('0',2-LEN(LTRIM(STR(MC2))))+LTRIM(STR(MC2))
   MPC3= REPLICATE('0',3-LEN(LTRIM(STR(MC3))))+LTRIM(STR(MC3))

IF _DOS
   SET COLOR TO /w
ENDIF

   @ R, 5 SAY MPC1 PICTURE '99' FONT 'FoxFont',11
   @ R, 8 SAY MPC2 PICTURE '99' FONT 'FoxFont',11
   @ R, 11 SAY MPC3 PICTURE '999' FONT 'FoxFont',11

IF _DOS
   SET COLOR TO 7/1
ENDIF

   SELECT 3
   STORE STR(MC1,2)+STR(MC2,2)+STR(MC3,3) TO MCODE
   SEEK MCODE

   IF FOUND()
      @ R, 15 SAY TITLE FONT 'FoxFont',11
   ENDIF

   SELECT 1

IF _DOS
   SET COLOR TO 7/1
ENDIF

   @ 5, 32 SAY 'Description   ' FONT 'FoxFont',11

IF _DOS
   SET COLOR TO /w
ENDIF

   @ 5, 45 SAY ALLTRIM(DESCRIP);
      PICTURE "@! XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX";
      SIZE 1,30 ;
      FONT 'FoxFont',11


   @ R, 46 SAY DR_CR PICTURE '@!' FONT 'FoxFont',11
   COL= IIF(DR_CR='DR',50,62)
   @ R, COL SAY AMOUNT PICTURE '999999,999.99' FONT 'FoxFont',11
   SKIP
   R= R+1
   IF R>19

IF _DOS
      SET COLOR TO 7/1
ENDIF

      RETURN
   ENDIF
ENDDO

IF _DOS
SET COLOR TO 7/1
ENDIF


RETURN
*******************
